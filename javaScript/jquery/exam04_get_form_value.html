<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      function handleCheckData() {
        console.log("~~~~~~~");
        let checkDataResult = true;
        event.preventDefault();

        //ID 유효성 검사
        /*
                / - start of regex
                ^ - start of line
                $ - end of line
                / - end of regex

                /.../ : ...을 포함하고 있으면 true
                /^...$/ : ...이 전확히 일치한다면 true
            */
        var uidPattern = /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).{6,10}$/;
        let uid = $("#uid").val();

        var uidPatternTest = uidPattern.test(uid);
        if (uidPatternTest) {
            $("#uid").removeClass("bg-danger");
        } else {
            $("#uid").addClass("bg-danger");
          checkDataResult = false;
        }

        //Email 유효성 검사
        //이메일 검사
        var emailPattern = /^[a-zA-Z0-9+-\_.]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;
        // var email = document.querySelector("#email").value;
        var email = $("#email").val();
        var emailPatternTest = emailPattern.test(email);
        if (emailPatternTest) {
            $("#email").removeClass("bg-danger");
        } else {
            $("#email").addClass("bg-danger");
            checkDataResult = false;
        }
        
        //Password 유효성 검사
        var passwordPattern = /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).{8,15}$/;
        // var passwordPattern = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,15}$/;
        // var password = document.querySelector("#password").value;
        var password = $("#password").val();
        var passwordPatternTest = passwordPattern.test(password);
        if (passwordPatternTest) {
            $("#password").removeClass("bg-danger");
        } else {
            $("#password").addClass("bg-danger");
            checkDataResult = false;
        }
        
        //Phone 유효성 검사
        var phonePattern = /^010-\d{3,4}-\d{4}$/;
        // var phone = document.querySelector("#phone").value;
        var phone = $("#phone").val();
        var phonePatternTest = phonePattern.test(phone);
        if (phonePatternTest) {
            $("#phone").removeClass("bg-danger");
        } else {
            $("#phone").addClass("bg-danger");
          checkDataResult = false;
        }

        //취메에서 체크된 것만 가져오기
        var hobbies = $("[name=hobby]:checked");
        // for(var i=0; i<hobbies.length; i++) {
        //     console.log(hobbies[i].value);
        // }
        for(var hobby of hobbies) {
            console.log(hobby.value);
        }

        //모든 유효성 검사를 통과한다면,
        console.log(checkDataResult);
        if(checkDataResult) {
            //제출하기
            // document.querySelector("#joinForm").submit();
            $("#joinForm")[0].submit();

            //submit 이벤트 발생 -> handleCheckData() 실행
            // $("#joinForm").submit(); //submit 이벤트 발생
        }
      }
    </script>
  </head>
  <body>
    <div class="card">
      <div class="card-header">Form Validate(입력값 유효성 검사)</div>

      <div class="card-body">
        <form id="joinForm" name="joinForm" action="#" onsubmit="handleCheckData()" novalidate>
          <div class="form-group">
            <label for="uid">ID</label>
            <input type="text" class="form-control" id="uid" name="uid" value="Abc123" />
            <small id="uidHelp" class="form-text text-muted">알파벳 대소문자, 숫자를 혼용해서 6자 이상 10자 이하</small>
          </div>

          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" class="form-control" id="email" name="email" />
          </div>

          <div class="form-group">
            <label for="password">Password</label>
            <input type="password" class="form-control" id="password" name="password" value="Abc12345" />
            <small id="passwordHelp" class="form-text text-muted">알파벳 대소문자, 숫자를 혼용해서 8자이상 15자이하</small>
          </div>

          <div class="form-group">
            <label for="phone">Phone</label>
            <input type="text" class="form-control" id="phone" />
            <small id="phoneHelp" class="form-text text-muted">예) 010-123-1234, 010-1234-1234</small>
          </div>

          <div class="form-group">
            <label for="city">City</label>
            <select id="city" name="city" class="form-control">
              <option selected value="seoul">서울</option>
              <option value="pusan">부산</option>
              <option value="jeju">제주</option>
            </select>
          </div>

          <div class="form-group">
            <label for="city">Hobby</label>
            <div class="form-check">
              <input type="checkbox" name="hobby" value="movie" />
              <label> 영화 </label>
              <input type="checkbox" name="hobby" value="trip" />
              <label> 여행 </label>
              <input type="checkbox" name="hobby" value="game" />
              <label> 게임 </label>
            </div>
          </div>

          <div class="form-group">
            <label for="city">Job</label>
            <div class="form-check">
              <input type="radio" name="job" value="developer" />
              <label> 개발자 </label>
              <input type="radio" name="job" value="designer" checked />
              <label> 디자이너 </label>
              <input type="radio" name="job" value="manager" />
              <label> 매니저 </label>
            </div>
          </div>
          <div class="text-center">
            <input type="submit" class="btn btn-primary" value="Join" />
            <input type="reset" class="btn btn-primary" value="Reset" />
          </div>
        </form>
      </div>
    </div>
  </body>
</html>